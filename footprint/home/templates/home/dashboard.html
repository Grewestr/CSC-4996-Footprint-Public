
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/header.css' %}">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo-and-title">
                <a href="{% url 'homepage' %}" class="logo-link">
                    <img src="{% static 'images/logo.png' %}" alt="Logo" class="logo-image">
                </a>
                <h1 class="site-title">Footprint</h1>
            </div>
            <nav class="nav">
                <a href="{% url 'upload' %}" class="nav-link">Upload</a>
                <a href="{% url 'profile' %}" class="nav-link">Profile</a>
                <a href="{% url 'support' %}" class="nav-link">Support</a>
                <a href="{% url 'logout' %}" class="nav-link">Logout</a>
            </nav>
        </div>
    </header>

    <!-- Dashboard Layout -->
    <div class="dashboard-layout container">
        <form method="POST" action="{% url 'search_attributes1' %}">
            {% csrf_token %}
            <input type="hidden" name="top_attribute" id="top-attribute-input">
            <input type="hidden" name="top_color" id="top-color-input">
            <input type="hidden" name="middle_attribute" id="middle-attribute-input">
            <input type="hidden" name="middle_color" id="middle-color-input">
            <input type="hidden" name="bottom_attribute" id="bottom-attribute-input">
            <input type="hidden" name="bottom_color" id="bottom-color-input">
        
            <!-- Attributes Section -->
            <aside class="attributes-section">
                <h2>Attributes</h2>
                <!-- Top Attributes -->
                <div class="attribute-group">
                    <h3>TOP</h3>
                    <div class="top-attributes">
                        <button type="button" class="attribute-btn" data-attribute="short_hair" data-category="top">Short Hair</button>
                        <button type="button" class="attribute-btn" data-attribute="medium_hair" data-category="top">Medium Hair</button>
                        <button type="button" class="attribute-btn" data-attribute="long_hair" data-category="top">Long Hair</button>
                        <button type="button" class="attribute-btn" data-attribute="no_hair" data-category="top">No Hair</button>
                    </div>

                    <div class="color-selection">
                        <label for="top-color">Color:</label>
                        <select id="top-color" name="top_color" class="color-select" data-category="top">
                            <option value="">Select Color</option>
                            <option value="black">Black</option>
                            <option value="brown">Brown</option>
                            <option value="red">Red</option>
                            <option value="gray">Gray</option>
                            <option value="blonde">Blonde</option>
                            <option value="unnatural">Unnatural</option>
                        </select>                   
                    </div>
                </div>

                <!-- Middle Attributes -->
                <div class="attribute-group">
                    <h3>MIDDLE</h3>
                    <div class="middle-attributes">
                        <button type="button" class="attribute-btn" data-attribute="short_sleeved" data-category="middle">Short Sleeved</button>
                        <button type="button" class="attribute-btn" data-attribute="long_sleeved" data-category="middle">Long Sleeved</button>
                        <button type="button" class="attribute-btn" data-attribute="sleeveless_shirt" data-category="middle">Sleevsless Shirt</button>
                        <button type="button" class="attribute-btn" data-attribute="no_shirt" data-category="middle">No Shirt</button>
                    </div>
                    
                    <div class="color-selection">
                        <label for="middle-color">Color:</label>
                        <select id="middle-color" name="middle_color" class="color-select" data-category="middle">
                            <option value="">Select Color</option>
                            <option value="black">Black</option>
                            <option value="brown">Brown</option>
                            <option value="red">Red</option>
                            <option value="gray">Gray</option>
                            <option value="green">Green</option>
                            <option value="blue">Blue</option>
                            <option value="white">White</option>
                            <option value="orange">Orange</option>
                            <option value="yellow">Yellow</option>
                            <option value="purple">Purple</option>
                            <option value="pink">Pink</option>
                            <option value="tan">Tan</option>
                        </select>                        
                    </div>
                </div>

                <!-- Bottom Attributes -->
                <div class="attribute-group">
                    <h3>BOTTOM</h3>
                    <div class="bottom-attributes">
                        <button type="button" class="attribute-btn" data-attribute="shorts" data-category="bottom">Shorts</button>
                        <button type="button" class="attribute-btn" data-attribute="pants" data-category="bottom">Pants</button>
                        <button type="button" class="attribute-btn" data-attribute="skirt" data-category="bottom">Skirt</button>
                    </div>
                    <div class="color-selection">
                        <label for="bottom-color">Color:</label>
                        <select id="bottom-color" name="bottom_color" class="color-select" data-category="bottom">
                            <option value="">Select Color</option>
                            <option value="black">Black</option>
                            <option value="brown">Brown</option>
                            <option value="red">Red</option>
                            <option value="gray">Gray</option>
                            <option value="green">Green</option>
                            <option value="blue">Blue</option>
                            <option value="white">White</option>
                            <option value="orange">Orange</option>
                            <option value="yellow">Yellow</option>
                            <option value="purple">Purple</option>
                            <option value="pink">Pink</option>
                            <option value="tan">Tan</option>
                        </select>
                    </div>
                </div>
            </aside>

            <!-- video Selection Section -->
            <section class="feed-selection-section">
                <h2>Video Selection</h2>
                <div class="feed-select">
                    <label for="feed_name">Video:</label>
                    <select id="feed_name" name="feed_name" required>
                        <option value="">Select Video</option>
                        {% for feed in feeds %}
                            <option value="{{ feed }}">{{ feed }}</option>
                        {% endfor %}
                    </select>
                </div>
            </section>

            <!-- Summary Section -->
            <section class="summary-section">
                <h2>Summary</h2>
                <div class="summary-content">
                    <p id="summary-top">Top: </p>
                    <p id="summary-middle">Middle: </p>
                    <p id="summary-bottom">Bottom: </p>
                    <p id="summary-feed_name">Feed: </p>
                    <button type="reset" class="reset-button">Reset</button>
                    <button type="submit" class="submit-button">Submit</button>
                </div>
            </section>
        </form>

        <section class="results-section">
            <h2>Results</h2>
            <div id="results-content">
                {% if exact_matches %}
                    <h3>100% Match</h3>
                    <p>Number of exact matches: {{ exact_matches|length }}</p>
                    {% for result in exact_matches %}
                        <div class="result-content">
                            <img src="{{ result.photo }}" alt="Result Image" class="result-image">
                            <div class="result-text">
                                <p><strong>Top:</strong> <span class="{% if 'unmatched' in result.top_type %}unmatched{% endif %}">{{ result.top_type }}</span>, <span class="{% if 'unmatched' in result.top_color %}unmatched{% endif %}">{{ result.top_color }}</span></p>
                                <p><strong>Middle:</strong> <span class="{% if 'unmatched' in result.middle_type %}unmatched{% endif %}">{{ result.middle_type }}</span>, <span class="{% if 'unmatched' in result.middle_color %}unmatched{% endif %}">{{ result.middle_color }}</span></p>
                                <p><strong>Bottom:</strong> <span class="{% if 'unmatched' in result.bottom_type %}unmatched{% endif %}">{{ result.bottom_type }}</span>, <span class="{% if 'unmatched' in result.bottom_color %}unmatched{% endif %}">{{ result.bottom_color }}</span></p>
                                <p><strong>Time Detected:</strong> {{ result.detection_time }}</p>
                                <p><strong>Detection Time Link:</strong> <a href="{{ result.detection_time_link }}" target="_blank">View</a></p>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
                
                {% if high_matches %}
                    <h3>80-90% Match</h3>
                    <p>Number of high matches: {{ high_matches|length }}</p>
                    {% for result in high_matches %}
                        <div class="result-content">
                            <img src="{{ result.photo }}" alt="Result Image" class="result-image">
                            <div class="result-text">
                                <p><strong>Top:</strong> <span class="{% if 'unmatched' in result.top_type %}unmatched{% endif %}">{{ result.top_type }}</span>, <span class="{% if 'unmatched' in result.top_color %}unmatched{% endif %}">{{ result.top_color }}</span></p>
                                <p><strong>Middle:</strong> <span class="{% if 'unmatched' in result.middle_type %}unmatched{% endif %}">{{ result.middle_type }}</span>, <span class="{% if 'unmatched' in result.middle_color %}unmatched{% endif %}">{{ result.middle_color }}</span></p>
                                <p><strong>Bottom:</strong> <span class="{% if 'unmatched' in result.bottom_type %}unmatched{% endif %}">{{ result.bottom_type }}</span>, <span class="{% if 'unmatched' in result.bottom_color %}unmatched{% endif %}">{{ result.bottom_color }}</span></p>
                                <p><strong>Time Detected:</strong> {{ result.detection_time }}</p>
                                <p><strong>Detection Time Link:</strong> <a href="{{ result.detection_time_link }}" target="_blank">View</a></p>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
                
                {% if medium_matches %}
                    <h3>60-70% Match</h3>
                    <p>Number of medium matches: {{ medium_matches|length }}</p>
                    {% for result in medium_matches %}
                        <div class="result-content">
                            <img src="{{ result.photo }}" alt="Result Image" class="result-image">
                            <div class="result-text">
                                <p><strong>Top:</strong> <span class="{% if 'unmatched' in result.top_type %}unmatched{% endif %}">{{ result.top_type }}</span>, <span class="{% if 'unmatched' in result.top_color %}unmatched{% endif %}">{{ result.top_color }}</span></p>
                                <p><strong>Middle:</strong> <span class="{% if 'unmatched' in result.middle_type %}unmatched{% endif %}">{{ result.middle_type }}</span>, <span class="{% if 'unmatched' in result.middle_color %}unmatched{% endif %}">{{ result.middle_color }}</span></p>
                                <p><strong>Bottom:</strong> <span class="{% if 'unmatched' in result.bottom_type %}unmatched{% endif %}">{{ result.bottom_type }}</span>, <span class="{% if 'unmatched' in result.bottom_color %}unmatched{% endif %}">{{ result.bottom_color }}</span></p>
                                <p><strong>Time Detected:</strong> {{ result.detection_time }}</p>
                                <p><strong>Detection Time Link:</strong> <a href="{{ result.detection_time_link }}" target="_blank">View</a></p>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        </section>
        
        
        
        
        
    </div>

    <footer>
        <p>2024 FOOTPRINT</p>
    </footer>

    <!-- Script to update summary dynamically, handle submit, and enforce validation -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const attributeButtons = document.querySelectorAll('.attribute-btn');
            const colorSelects = document.querySelectorAll('.color-select');
            const feedSelect = document.getElementById('feed_name');

            const summaryTop = document.getElementById('summary-top');
            const summaryMiddle = document.getElementById('summary-middle');
            const summaryBottom = document.getElementById('summary-bottom');
            const summaryFeedName = document.getElementById('summary-feed_name');

            // Store current selections
            let selections = {
                top: { attribute: '', color: '' },
                middle: { attribute: '', color: '' },
                bottom: { attribute: '', color: '' },
                feed_name: ''
            };

            function updateSummary(category) {
                const attribute = selections[category].attribute;
                const color = selections[category].color;
                const summaryElement = document.getElementById(`summary-${category}`);
                let summaryText = category.charAt(0).toUpperCase() + category.slice(1) + ': ';

                if (attribute && color) {
                    summaryText += `${attribute}, ${color}`;
                } else if (attribute) {
                    summaryText += `${attribute}`;
                } else if (color) {
                    summaryText += `Color: ${color}`;
                } else {
                    summaryText += '';
                }

                summaryElement.textContent = summaryText;
                document.getElementById(`${category}-attribute-input`).value = attribute || '';
                document.getElementById(`${category}-color-input`).value = color.toLowerCase() || '';
            }

            attributeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    const attribute = this.getAttribute('data-attribute');
                    selections[category].attribute = attribute;
                    document.querySelectorAll(`.attribute-btn[data-category="${category}"]`).forEach(btn => btn.classList.remove('selected'));
                    this.classList.add('selected');
                    updateSummary(category);
                });
            });

            colorSelects.forEach(select => {
                select.addEventListener('change', function() {
                    const category = this.getAttribute('data-category');
                    const color = this.value;
                    selections[category].color = color;
                    updateSummary(category);
                });
            });

            feedSelect.addEventListener('change', function() {
                selections.feed_name = this.value;
                summaryFeedName.textContent = `Feed: ${selections.feed_name}`;
            });

            document.querySelector('.reset-button').addEventListener('click', () => {
                selections = { top: { attribute: '', color: '' }, middle: { attribute: '', color: '' }, bottom: { attribute: '', color: '' }, feed_name: '' };
                summaryTop.textContent = 'Top: ';
                summaryMiddle.textContent = 'Middle: ';
                summaryBottom.textContent = 'Bottom: ';
                summaryFeedName.textContent = 'Feed: ';
                colorSelects.forEach(select => select.value = '');
                feedSelect.value = '';
                attributeButtons.forEach(button => button.classList.remove('selected'));
            });

            document.querySelector('form').addEventListener('submit', function(event) {
                let valid = true;
                let errorMessage = '';
                ['top', 'middle', 'bottom'].forEach(category => {
                    if (!selections[category].attribute) {
                        valid = false;
                        errorMessage += `Please select a ${category} attribute.\n`;
                    }
                    if (!selections[category].color) {
                        valid = false;
                        errorMessage += `Please select a ${category} color.\n`;
                    }
                });

                if (!selections.feed_name) {
                    valid = false;
                    errorMessage += 'Please select a feed.\n';
                }

                if (!valid) {
                    event.preventDefault();
                    alert(errorMessage);
                }
            });
        });
    </script>
</body>
</html>
